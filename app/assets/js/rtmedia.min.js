/*! 
 * rtMedia JavaScript Library 
 * @package rtMedia 
 */

function apply_rtMagnificPopup(e){jQuery("document").ready(function(t){var i="";i="undefined"==typeof rtmedia_load_more?"Loading media":rtmedia_load_more,"undefined"!=typeof rtmedia_lightbox_enabled&&"1"==rtmedia_lightbox_enabled&&(t(".activity-item .rtmedia-activity-container .rtmedia-list-item > a").siblings("p").children("a").length>0&&t(".activity-item .rtmedia-activity-container .rtmedia-list-item > a").siblings("p").children("a").addClass("no-popup"),rtMagnificPopup=jQuery(e).magnificPopup({delegate:"a:not(.no-popup, .mejs-time-slider, .mejs-volume-slider, .mejs-horizontal-volume-slider)",type:"ajax",tLoading:i+" #%curr%...",mainClass:"mfp-img-mobile",preload:[1,3],closeOnBgClick:!0,gallery:{enabled:!0,navigateByImgClick:!0,arrowMarkup:"",preload:[0,1]},image:{tError:'<a href="%url%">The image #%curr%</a> could not be loaded.',titleSrc:function(e){return e.el.attr("title")+"<small>by Marsel Van Oosten</small>"}},callbacks:{ajaxContentAdded:function(){e=jQuery.magnificPopup.instance,1===jQuery(e.items).size()&&jQuery(".mfp-arrow").remove();var e=jQuery.magnificPopup.instance,i=e.currItem.el,a=i.parent();if(a.is("li")||(a=a.parent()),(a.is(":nth-last-child(2)")||a.is(":last-child"))&&a.find("a").hasClass("rtmedia-list-item-a")){a.next();"block"==jQuery("#rtMedia-galary-next").css("display")&&jQuery("#rtMedia-galary-next").click()}var r=e.items.length;if(e.index!=r-1||a.is(":last-child")){var n={};"undefined"!=typeof _wpmejsSettings&&(n.pluginPath=_wpmejsSettings.pluginPath);var o=jQuery(".rtmedia-container .rtmedia-single-meta").height(),s=!1;void 0!==e&&void 0!==e.probablyMobile&&1==e.probablyMobile&&(s=!0),t(".mfp-content .rtmedia-single-media .wp-audio-shortcode,.mfp-content .rtmedia-single-media .wp-video-shortcode,.mfp-content .rtmedia-single-media .bp_media_content video").attr("autoplay",!0),s&&t(".mfp-content .rtmedia-single-media .wp-video-shortcode,.mfp-content .rtmedia-single-media .bp_media_content video").attr("muted",!1),t(".mfp-content .rtmedia-single-media .wp-audio-shortcode,.mfp-content .rtmedia-single-media .wp-video-shortcode,.mfp-content .rtmedia-single-media .bp_media_content video").mediaelementplayer({defaultVideoWidth:480,hideVolumeOnTouchDevices:!1,features:["playpause","progress","current","volume","fullscreen"],defaultVideoHeight:270,alwaysShowControls:s,enableAutosize:!0,clickToPlayPause:!0,videoHeight:-1,success:function(e,i){e.addEventListener("loadeddata",function(i){var a=t(e).height(),r=t(window).height(),n=jQuery("div.rtm-ltb-action-container").height(),s=o-(n=n+50);a>r&&jQuery(".rtmedia-container #rtmedia-single-media-container .mejs-container").attr("style","height:"+s+"px !important; transition:0.2s")},!1),s&&t(e).hasClass("wp-video-shortcode")?jQuery("body").on("touchstart",".mejs-overlay-button",function(t){e.paused?e.play():e.pause()}):e.play()}}),t(".mfp-content .mejs-audio .mejs-controls").css("position","relative"),rtMediaHook.call("rtmedia_js_popup_after_content_added",[]),"undefined"!=typeof bp&&void 0!==bp.mentions&&void 0!==bp.mentions.users&&(t("#atwho-container #atwho-ground-comment_content").remove(),t("#comment_content").bp_mentions(bp.mentions.users)),rtmedia_reset_video_and_audio_for_popup(),apply_rtMagnificPopup(".rtmedia-list-media.rtm-gallery-list, .rtmedia-activity-container ul.rtmedia-list, #bp-media-list,.bp-media-sc-list, li.media.album_updated ul,ul.bp-media-list-media, li.activity-item div.activity-content div.activity-inner div.bp_media_content, .rtm-bbp-container, ul.rtm-comment-container")}else i.click()},close:function(e){rtmedia_single_page_popup_close()},BeforeChange:function(e){}}})),jQuery(document).ajaxComplete(function(){jQuery("[id^=imgedit-leaving]").filter(function(){var e=jQuery(this).text();jQuery(this).text(e.replace("OK","Save"))})})})}function rtmedia_init_action_dropdown(e){var t,i;jQuery(e+" .click-nav > span,"+e+" .click-nav > div").toggleClass("no-js js"),jQuery(e+" .click-nav .js ul").hide(),jQuery(e+" .click-nav .clicker").click(function(e){t=jQuery("#rtm-media-options .click-nav .clicker").next("ul"),i=jQuery(this).next("ul"),jQuery.each(t,function(e,t){jQuery(t).html()!=i.html()&&jQuery(t).hide()}),jQuery(i).toggle(),e.stopPropagation()})}function bp_media_create_element(e){return!1}function rtmedia_version_compare(e,t){if(typeof e+typeof t!="stringstring")return!1;for(var i=e.split("."),a=t.split("."),r=0,n=Math.max(i.length,a.length);r<n;r++){if(i[r]&&!a[r]&&parseInt(i[r])>0||parseInt(i[r])>parseInt(a[r]))return!0;if(a[r]&&!i[r]&&parseInt(a[r])>0||parseInt(i[r])<parseInt(a[r]))return!1}return!0}function rtm_is_element_exist(e){return jQuery(e).length>0}function rtm_masonry_reload(e){setTimeout(function(){e.masonry("reload")},250)}function rtm_search_media_text_validation(){""===jQuery("#media_search_input").val()?jQuery("#media_search").css("cursor","not-allowed"):jQuery("#media_search").css("cursor","pointer")}function rtmediaGetParameterByName(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null==t?"":decodeURIComponent(t[1].replace(/\+/g," "))}function rtmedia_single_media_alert_message(e,t){var i="rtmedia-success";"warning"==t&&(i="rtmedia-warning"),jQuery(".rtmedia-single-media .rtmedia-media").css("opacity","0.2"),jQuery(".rtmedia-single-media .rtmedia-media").after("<div class='rtmedia-message-container'><span class='"+i+"'>"+e+" </span></div>"),setTimeout(function(){jQuery(".rtmedia-single-media .rtmedia-media").css("opacity","1"),jQuery(".rtmedia-message-container").remove()},3e3),jQuery(".rtmedia-message-container").click(function(){jQuery(".rtmedia-single-media .rtmedia-media").css("opacity","1"),jQuery(".rtmedia-message-container").remove()})}function rtmedia_gallery_action_alert_message(e,t){var i="rtmedia-success";"warning"==t&&(i="rtmedia-warning");jQuery("body").append('<div class="rtmedia-gallery-alert-container"> </div>'),jQuery(".rtmedia-gallery-alert-container").append("<div class='rtmedia-gallery-message-box'><span class='"+i+"'>"+e+" </span></div>"),setTimeout(function(){jQuery(".rtmedia-gallery-alert-container").remove()},3e3),jQuery(".rtmedia-gallery-message-box").click(function(){jQuery(".rtmedia-gallery-alert-container").remove()})}function rtmedia_activity_masonry(){jQuery("#activity-stream .rtmedia-activity-container .rtmedia-list").masonry({itemSelector:".rtmedia-list-item",gutter:7});var e=0,t=setInterval(function(){5===(e+=1)&&clearInterval(t),jQuery.each(jQuery(".rtmedia-activity-container .rtmedia-list.masonry .rtmedia-item-title"),function(e,t){jQuery(t).width(jQuery(t).siblings(".rtmedia-item-thumbnail").children("img").width())}),rtm_masonry_reload(jQuery("#activity-stream .rtmedia-activity-container .rtmedia-list"))},1e3)}function get_parameter(e,t){if(!e)return!1;t||(t=window.location.href);var i=(e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"))+"=([^&#]*)",a=new RegExp(i).exec(t);return null!==a&&a[1]}!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):window.jQuery||window.Zepto)}(function(e){var t,i,a,r,n,o,s=function(){},l=!!window.jQuery,c=e(window),d=function(e,i){t.ev.on("mfp"+e+".mfp",i)},m=function(t,i,a,r){var n=document.createElement("div");return n.className="mfp-"+t,a&&(n.innerHTML=a),r?i&&i.appendChild(n):(n=e(n),i&&n.appendTo(i)),n},u=function(i,a){t.ev.triggerHandler("mfp"+i,a),t.st.callbacks&&(i=i.charAt(0).toLowerCase()+i.slice(1),t.st.callbacks[i]&&t.st.callbacks[i].apply(t,e.isArray(a)?a:[a]))},p=function(i){return i===o&&t.currTemplate.closeBtn||(t.currTemplate.closeBtn=e(t.st.closeMarkup.replace("%title%",t.st.tClose)),o=i),t.currTemplate.closeBtn},f=function(){e.magnificPopup.instance||((t=new s).init(),e.magnificPopup.instance=t)},y=function(){var e=document.createElement("p").style,t=["ms","O","Moz","Webkit"];if(void 0!==e.transition)return!0;for(;t.length;)if(t.pop()+"Transition"in e)return!0;return!1};s.prototype={constructor:s,init:function(){var i=navigator.appVersion;t.isIE7=-1!==i.indexOf("MSIE 7."),t.isIE8=-1!==i.indexOf("MSIE 8."),t.isLowIE=t.isIE7||t.isIE8,t.isAndroid=/android/gi.test(i),t.isIOS=/iphone|ipad|ipod/gi.test(i),t.supportsTransition=y(),t.probablyMobile=t.isAndroid||t.isIOS||/(Opera Mini)|Kindle|webOS|BlackBerry|(Opera Mobi)|(Windows Phone)|IEMobile/i.test(navigator.userAgent),a=e(document),t.popupsCache={}},open:function(i){var r;if(!1===i.isObj){t.items=i.items.toArray(),t.index=0;var o,s=i.items;for(r=0;r<s.length;r++)if((o=s[r]).parsed&&(o=o.el[0]),o===i.el[0]){t.index=r;break}}else t.items=e.isArray(i.items)?i.items:[i.items],t.index=i.index||0;{if(!t.isOpen){t.types=[],n="",i.mainEl&&i.mainEl.length?t.ev=i.mainEl.eq(0):t.ev=a,i.key?(t.popupsCache[i.key]||(t.popupsCache[i.key]={}),t.currTemplate=t.popupsCache[i.key]):t.currTemplate={},t.st=e.extend(!0,{},e.magnificPopup.defaults,i),t.fixedContentPos="auto"===t.st.fixedContentPos?!t.probablyMobile:t.st.fixedContentPos,t.st.modal&&(t.st.closeOnContentClick=!1,t.st.closeOnBgClick=!1,t.st.showCloseBtn=!1,t.st.enableEscapeKey=!1),t.bgOverlay||(t.bgOverlay=m("bg").on("click.mfp",function(){t.close()}),t.wrap=m("wrap").attr("tabindex",-1).on("click.mfp",function(e){t._checkIfClose(e.target)&&t.close()}),t.container=m("container",t.wrap)),t.contentContainer=m("content"),t.st.preloader&&(t.preloader=m("preloader",t.container,t.st.tLoading));var l=e.magnificPopup.modules;for(r=0;r<l.length;r++){var f=l[r];f=f.charAt(0).toUpperCase()+f.slice(1),t["init"+f].call(t)}u("BeforeOpen"),t.st.showCloseBtn&&(t.st.closeBtnInside?(d("MarkupParse",function(e,t,i,a){i.close_replaceWith=p(a.type)}),n+=" mfp-close-btn-in"):t.wrap.append(p())),t.st.alignTop&&(n+=" mfp-align-top"),t.fixedContentPos?t.wrap.css({overflow:t.st.overflowY,overflowX:"hidden",overflowY:t.st.overflowY}):t.wrap.css({top:c.scrollTop(),position:"absolute"}),(!1===t.st.fixedBgPos||"auto"===t.st.fixedBgPos&&!t.fixedContentPos)&&t.bgOverlay.css({height:a.height(),position:"absolute"}),t.st.enableEscapeKey&&a.on("keyup.mfp",function(e){27===e.keyCode&&t.close()}),c.on("resize.mfp",function(){t.updateSize()}),t.st.closeOnContentClick||(n+=" mfp-auto-cursor"),n&&t.wrap.addClass(n);var y=t.wH=c.height(),g={};if(t.fixedContentPos&&t._hasScrollBar(y)){var _=t._getScrollbarSize();_&&(g.marginRight=_)}t.fixedContentPos&&(t.isIE7?e("body, html").css("overflow","hidden"):g.overflow="hidden");var h=t.st.mainClass;return t.isIE7&&(h+=" mfp-ie7"),h&&t._addClassToMFP(h),t.updateItemHTML(),u("BuildControls"),e("html").css(g),t.bgOverlay.add(t.wrap).prependTo(t.st.prependTo||e(document.body)),t._lastFocusedEl=document.activeElement,setTimeout(function(){t.content?(t._addClassToMFP("mfp-ready"),t._setFocus()):t.bgOverlay.addClass("mfp-ready"),a.on("focusin.mfp",t._onFocusIn)},16),t.isOpen=!0,t.updateSize(y),u("Open"),i}t.updateItemHTML()}},close:function(){t.isOpen&&(u("BeforeClose"),t.isOpen=!1,t.st.removalDelay&&!t.isLowIE&&t.supportsTransition?(t._addClassToMFP("mfp-removing"),setTimeout(function(){t._close()},t.st.removalDelay)):t._close())},_close:function(){u("Close");var i="mfp-removing mfp-ready ";if(t.bgOverlay.detach(),t.wrap.detach(),t.container.empty(),t.st.mainClass&&(i+=t.st.mainClass+" "),t._removeClassFromMFP(i),t.fixedContentPos){var r={marginRight:""};t.isIE7?e("body, html").css("overflow",""):r.overflow="",e("html").css(r)}a.off("keyup.mfp focusin.mfp"),t.ev.off(".mfp"),t.wrap.attr("class","mfp-wrap").removeAttr("style"),t.bgOverlay.attr("class","mfp-bg"),t.container.attr("class","mfp-container"),!t.st.showCloseBtn||t.st.closeBtnInside&&!0!==t.currTemplate[t.currItem.type]||t.currTemplate.closeBtn&&t.currTemplate.closeBtn.detach(),t._lastFocusedEl&&e(t._lastFocusedEl).focus(),t.currItem=null,t.content=null,t.currTemplate=null,t.prevHeight=0,u("AfterClose")},updateSize:function(e){if(t.isIOS){var i=document.documentElement.clientWidth/window.innerWidth,a=window.innerHeight*i;t.wrap.css("height",a),t.wH=a}else t.wH=e||c.height();t.fixedContentPos||t.wrap.css("height",t.wH),u("Resize")},updateItemHTML:function(){var i=t.items[t.index];t.contentContainer.detach(),t.content&&t.content.detach(),i.parsed||(i=t.parseEl(t.index));var a=i.type;if(u("BeforeChange",[t.currItem?t.currItem.type:"",a]),t.currItem=i,!t.currTemplate[a]){var n=!!t.st[a]&&t.st[a].markup;u("FirstMarkupParse",n),t.currTemplate[a]=!n||e(n)}r&&r!==i.type&&t.container.removeClass("mfp-"+r+"-holder");var o=t["get"+a.charAt(0).toUpperCase()+a.slice(1)](i,t.currTemplate[a]);t.appendContent(o,a),i.preloaded=!0,u("Change",i),r=i.type,t.container.prepend(t.contentContainer),u("AfterChange")},appendContent:function(e,i){t.content=e,e?t.st.showCloseBtn&&t.st.closeBtnInside&&!0===t.currTemplate[i]?t.content.find(".mfp-close").length||t.content.append(p()):t.content=e:t.content="",u("BeforeAppend"),t.container.addClass("mfp-"+i+"-holder"),t.contentContainer.append(t.content)},parseEl:function(i){var a,r=t.items[i];if(r.tagName?r={el:e(r)}:(a=r.type,r={data:r,src:r.src}),r.el){for(var n=t.types,o=0;o<n.length;o++)if(r.el.hasClass("mfp-"+n[o])){a=n[o];break}r.src=r.el.attr("data-mfp-src"),r.src||(r.src=r.el.attr("href"))}return r.type=a||t.st.type||"inline",r.index=i,r.parsed=!0,t.items[i]=r,u("ElementParse",r),t.items[i]},addGroup:function(e,i){var a=function(a){a.mfpEl=this,t._openClick(a,e,i)};i||(i={});var r="click.magnificPopup";i.mainEl=e,i.items?(i.isObj=!0,e.off(r).on(r,a)):(i.isObj=!1,i.delegate?e.off(r).on(r,i.delegate,a):(i.items=e,e.off(r).on(r,a)))},_openClick:function(i,a,r){if((void 0!==r.midClick?r.midClick:e.magnificPopup.defaults.midClick)||2!==i.which&&!i.ctrlKey&&!i.metaKey){var n=void 0!==r.disableOn?r.disableOn:e.magnificPopup.defaults.disableOn;if(n)if(e.isFunction(n)){if(!n.call(t))return!0}else if(c.width()<n)return!0;i.type&&(i.preventDefault(),t.isOpen&&i.stopPropagation()),r.el=e(i.mfpEl),r.delegate&&(r.items=a.find(r.delegate)),t.open(r)}},updateStatus:function(e,a){if(t.preloader){i!==e&&t.container.removeClass("mfp-s-"+i),a||"loading"!==e||(a=t.st.tLoading);var r={status:e,text:a};u("UpdateStatus",r),e=r.status,a=r.text,t.preloader.html(a),t.preloader.find("a").on("click",function(e){e.stopImmediatePropagation()}),t.container.addClass("mfp-s-"+e),i=e}},_checkIfClose:function(i){if(!e(i).hasClass("mfp-prevent-close")){var a=t.st.closeOnContentClick,r=t.st.closeOnBgClick;if(a&&r)return!0;if(!t.content||e(i).hasClass("mfp-close")||t.preloader&&i===t.preloader[0])return!0;if(i===t.content[0]||e.contains(t.content[0],i)){if(a)return!0}else if(r&&e.contains(document,i))return!0;return!1}},_addClassToMFP:function(e){t.bgOverlay.addClass(e),t.wrap.addClass(e)},_removeClassFromMFP:function(e){this.bgOverlay.removeClass(e),t.wrap.removeClass(e)},_hasScrollBar:function(e){return(t.isIE7?a.height():document.body.scrollHeight)>(e||c.height())},_setFocus:function(){(t.st.focus?t.content.find(t.st.focus).eq(0):t.wrap).focus()},_onFocusIn:function(i){if(i.target!==t.wrap[0]&&!e.contains(t.wrap[0],i.target))return t._setFocus(),!1},_parseMarkup:function(t,i,a){var r;a.data&&(i=e.extend(a.data,i)),u("MarkupParse",[t,i,a]),e.each(i,function(e,i){if(void 0===i||!1===i)return!0;if((r=e.split("_")).length>1){var a=t.find(".mfp-"+r[0]);if(a.length>0){var n=r[1];"replaceWith"===n?a[0]!==i[0]&&a.replaceWith(i):"img"===n?a.is("img")?a.attr("src",i):a.replaceWith('<img src="'+i+'" class="'+a.attr("class")+'" />'):a.attr(r[1],i)}}else t.find(".mfp-"+e).html(i)})},_getScrollbarSize:function(){if(void 0===t.scrollbarSize){var e=document.createElement("div");e.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",document.body.appendChild(e),t.scrollbarSize=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return t.scrollbarSize}},e.magnificPopup={instance:null,proto:s.prototype,modules:[],open:function(t,i){return f(),t=t?e.extend(!0,{},t):{},t.isObj=!0,t.index=i||0,this.instance.open(t)},close:function(){return e.magnificPopup.instance&&e.magnificPopup.instance.close()},registerModule:function(t,i){i.options&&(e.magnificPopup.defaults[t]=i.options),e.extend(this.proto,i.proto),this.modules.push(t)},defaults:{disableOn:0,key:null,midClick:!1,mainClass:"",preloader:!0,focus:"",closeOnContentClick:!1,closeOnBgClick:!0,closeBtnInside:!0,showCloseBtn:!0,enableEscapeKey:!0,modal:!1,alignTop:!1,removalDelay:0,prependTo:null,fixedContentPos:"auto",fixedBgPos:"auto",overflowY:"auto",closeMarkup:'<button title="%title%" type="button" class="mfp-close">&times;</button>',tClose:"Close (Esc)",tLoading:"Loading..."}},e.fn.magnificPopup=function(i){f();var a=e(this);if("string"==typeof i)if("open"===i){var r,n=l?a.data("magnificPopup"):a[0].magnificPopup,o=parseInt(arguments[1],10)||0;n.items?r=n.items[o]:(r=a,n.delegate&&(r=r.find(n.delegate)),r=r.eq(o)),t._openClick({mfpEl:r},a,n)}else t.isOpen&&t[i].apply(t,Array.prototype.slice.call(arguments,1));else i=e.extend(!0,{},i),l?a.data("magnificPopup",i):a[0].magnificPopup=i,t.addGroup(a,i);return a};var g,_,h,v=function(){h&&(_.after(h.addClass(g)).detach(),h=null)};e.magnificPopup.registerModule("inline",{options:{hiddenClass:"hide",markup:"",tNotFound:"Content not found"},proto:{initInline:function(){t.types.push("inline"),d("Close.inline",function(){v()})},getInline:function(i,a){if(v(),i.src){var r=t.st.inline,n=e(i.src);if(n.length){var o=n[0].parentNode;o&&o.tagName&&(_||(g=r.hiddenClass,_=m(g),g="mfp-"+g),h=n.after(_).detach().removeClass(g)),t.updateStatus("ready")}else t.updateStatus("error",r.tNotFound),n=e("<div>");return i.inlineElement=n,n}return t.updateStatus("ready"),t._parseMarkup(a,{},i),a}}});var b,j=function(){b&&e(document.body).removeClass(b)},w=function(){j(),t.req&&t.req.abort()};e.magnificPopup.registerModule("ajax",{options:{settings:null,cursor:"mfp-ajax-cur",tError:'<a href="%url%">The content</a> could not be loaded.'},proto:{initAjax:function(){t.types.push("ajax"),b=t.st.ajax.cursor,d("Close.ajax",w),d("BeforeChange.ajax",w)},getAjax:function(i){b&&e(document.body).addClass(b),t.updateStatus("loading");var a=e.extend({url:i.src,success:function(a,r,n){var o={data:a,xhr:n};u("ParseAjax",o),t.appendContent(e(o.data),"ajax"),i.finished=!0,j(),t._setFocus(),setTimeout(function(){t.wrap.addClass("mfp-ready")},16),t.updateStatus("ready"),u("AjaxContentAdded")},error:function(){j(),i.finished=i.loadError=!0,t.updateStatus("error",t.st.ajax.tError.replace("%url%",i.src))}},t.st.ajax.settings);return t.req=e.ajax(a),""}}});var C,Q=function(i){if(i.data&&void 0!==i.data.title)return i.data.title;var a=t.st.image.titleSrc;if(a){if(e.isFunction(a))return a.call(t,i);if(i.el)return i.el.attr(a)||""}return""};e.magnificPopup.registerModule("image",{options:{markup:'<div class="mfp-figure"><div class="mfp-close"></div><figure><div class="mfp-img"></div><figcaption><div class="mfp-bottom-bar"><div class="mfp-title"></div><div class="mfp-counter"></div></div></figcaption></figure></div>',cursor:"mfp-zoom-out-cur",titleSrc:"title",verticalFit:!0,tError:'<a href="%url%">The image</a> could not be loaded.'},proto:{initImage:function(){var i=t.st.image,a=".image";t.types.push("image"),d("Open"+a,function(){"image"===t.currItem.type&&i.cursor&&e(document.body).addClass(i.cursor)}),d("Close"+a,function(){i.cursor&&e(document.body).removeClass(i.cursor),c.off("resize.mfp")}),d("Resize"+a,t.resizeImage),t.isLowIE&&d("AfterChange",t.resizeImage)},resizeImage:function(){var e=t.currItem;if(e&&e.img&&t.st.image.verticalFit){var i=0;t.isLowIE&&(i=parseInt(e.img.css("padding-top"),10)+parseInt(e.img.css("padding-bottom"),10)),e.img.css("max-height",t.wH-i)}},_onImageHasSize:function(e){e.img&&(e.hasSize=!0,C&&clearInterval(C),e.isCheckingImgSize=!1,u("ImageHasSize",e),e.imgHidden&&(t.content&&t.content.removeClass("mfp-loading"),e.imgHidden=!1))},findImageSize:function(e){var i=0,a=e.img[0],r=function(n){C&&clearInterval(C),C=setInterval(function(){a.naturalWidth>0?t._onImageHasSize(e):(i>200&&clearInterval(C),3===++i?r(10):40===i?r(50):100===i&&r(500))},n)};r(1)},getImage:function(i,a){var r=0,n=function(){i&&(i.img[0].complete?(i.img.off(".mfploader"),i===t.currItem&&(t._onImageHasSize(i),t.updateStatus("ready")),i.hasSize=!0,i.loaded=!0,u("ImageLoadComplete")):++r<200?setTimeout(n,100):o())},o=function(){i&&(i.img.off(".mfploader"),i===t.currItem&&(t._onImageHasSize(i),t.updateStatus("error",s.tError.replace("%url%",i.src))),i.hasSize=!0,i.loaded=!0,i.loadError=!0)},s=t.st.image,l=a.find(".mfp-img");if(l.length){var c=document.createElement("img");c.className="mfp-img",i.el&&i.el.find("img").length&&(c.alt=i.el.find("img").attr("alt")),i.img=e(c).on("load.mfploader",n).on("error.mfploader",o),c.src=i.src,l.is("img")&&(i.img=i.img.clone()),(c=i.img[0]).naturalWidth>0?i.hasSize=!0:c.width||(i.hasSize=!1)}return t._parseMarkup(a,{title:Q(i),img_replaceWith:i.img},i),t.resizeImage(),i.hasSize?(C&&clearInterval(C),i.loadError?(a.addClass("mfp-loading"),t.updateStatus("error",s.tError.replace("%url%",i.src))):(a.removeClass("mfp-loading"),t.updateStatus("ready")),a):(t.updateStatus("loading"),i.loading=!0,i.hasSize||(i.imgHidden=!0,a.addClass("mfp-loading"),t.findImageSize(i)),a)}}});var k,x=function(){return void 0===k&&(k=void 0!==document.createElement("p").style.MozTransform),k};e.magnificPopup.registerModule("zoom",{options:{enabled:!1,easing:"ease-in-out",duration:300,opener:function(e){return e.is("img")?e:e.find("img")}},proto:{initZoom:function(){var e,i=t.st.zoom,a=".zoom";if(i.enabled&&t.supportsTransition){var r,n,o=i.duration,s=function(e){var t=e.clone().removeAttr("style").removeAttr("class").addClass("mfp-animated-image"),a="all "+i.duration/1e3+"s "+i.easing,r={position:"fixed",zIndex:9999,left:0,top:0,"-webkit-backface-visibility":"hidden"},n="transition";return r["-webkit-"+n]=r["-moz-"+n]=r["-o-"+n]=r[n]=a,t.css(r),t},l=function(){t.content.css("visibility","visible")};d("BuildControls"+a,function(){if(t._allowZoom()){if(clearTimeout(r),t.content.css("visibility","hidden"),!(e=t._getItemToZoom()))return void l();(n=s(e)).css(t._getOffset()),t.wrap.append(n),r=setTimeout(function(){n.css(t._getOffset(!0)),r=setTimeout(function(){l(),setTimeout(function(){n.remove(),e=n=null,u("ZoomAnimationEnded")},16)},o)},16)}}),d("BeforeClose"+a,function(){if(t._allowZoom()){if(clearTimeout(r),t.st.removalDelay=o,!e){if(!(e=t._getItemToZoom()))return;n=s(e)}n.css(t._getOffset(!0)),t.wrap.append(n),t.content.css("visibility","hidden"),setTimeout(function(){n.css(t._getOffset())},16)}}),d("Close"+a,function(){t._allowZoom()&&(l(),n&&n.remove(),e=null)})}},_allowZoom:function(){return"image"===t.currItem.type},_getItemToZoom:function(){return!!t.currItem.hasSize&&t.currItem.img},_getOffset:function(i){var a,r=(a=i?t.currItem.img:t.st.zoom.opener(t.currItem.el||t.currItem)).offset(),n=parseInt(a.css("padding-top"),10),o=parseInt(a.css("padding-bottom"),10);r.top-=e(window).scrollTop()-n;var s={width:a.width(),height:(l?a.innerHeight():a[0].offsetHeight)-o-n};return x()?s["-moz-transform"]=s.transform="translate("+r.left+"px,"+r.top+"px)":(s.left=r.left,s.top=r.top),s}}});var I=function(e){if(t.currTemplate.iframe){var i=t.currTemplate.iframe.find("iframe");i.length&&(e||(i[0].src="//about:blank"),t.isIE8&&i.css("display",e?"block":"none"))}};e.magnificPopup.registerModule("iframe",{options:{markup:'<div class="mfp-iframe-scaler"><div class="mfp-close"></div><iframe class="mfp-iframe" src="//about:blank" frameborder="0" allowfullscreen></iframe></div>',srcAction:"iframe_src",patterns:{youtube:{index:"youtube.com",id:"v=",src:"//www.youtube.com/embed/%id%?autoplay=1"},vimeo:{index:"vimeo.com/",id:"/",src:"//player.vimeo.com/video/%id%?autoplay=1"},gmaps:{index:"//maps.google.",src:"%id%&output=embed"}}},proto:{initIframe:function(){t.types.push("iframe"),d("BeforeChange",function(e,t,i){t!==i&&("iframe"===t?I():"iframe"===i&&I(!0))}),d("Close.iframe",function(){I()})},getIframe:function(i,a){var r=i.src,n=t.st.iframe;e.each(n.patterns,function(){if(r.indexOf(this.index)>-1)return this.id&&(r="string"==typeof this.id?r.substr(r.lastIndexOf(this.id)+this.id.length,r.length):this.id.call(this,r)),r=this.src.replace("%id%",r),!1});var o={};return n.srcAction&&(o[n.srcAction]=r),t._parseMarkup(a,o,i),t.updateStatus("ready"),a}}});var T=function(e){var i=t.items.length;return e>i-1?e-i:e<0?i+e:e},M=function(e,t,i){return e.replace(/%curr%/gi,t+1).replace(/%total%/gi,i)};e.magnificPopup.registerModule("gallery",{options:{enabled:!1,arrowMarkup:'<button title="%title%" type="button" class="mfp-arrow mfp-arrow-%dir%"></button>',preload:[0,2],navigateByImgClick:!0,arrows:!0,tPrev:"Previous (Left arrow key)",tNext:"Next (Right arrow key)",tCounter:"%curr% of %total%"},proto:{initGallery:function(){var i=t.st.gallery,r=".mfp-gallery",o=Boolean(e.fn.mfpFastClick);if(t.direction=!0,!i||!i.enabled)return!1;n+=" mfp-gallery",d("Open"+r,function(){i.navigateByImgClick&&t.wrap.on("click"+r,".mfp-img",function(){if(t.items.length>1)return t.next(),!1}),a.on("keydown"+r,function(e){37===e.keyCode?t.prev():39===e.keyCode&&t.next()})}),d("UpdateStatus"+r,function(e,i){i.text&&(i.text=M(i.text,t.currItem.index,t.items.length))}),d("MarkupParse"+r,function(e,a,r,n){var o=t.items.length;r.counter=o>1?M(i.tCounter,n.index,o):""}),d("BuildControls"+r,function(){if(t.items.length>1&&i.arrows&&!t.arrowLeft){var a=i.arrowMarkup,r=t.arrowLeft=e(a.replace(/%title%/gi,i.tPrev).replace(/%dir%/gi,"left")).addClass("mfp-prevent-close"),n=t.arrowRight=e(a.replace(/%title%/gi,i.tNext).replace(/%dir%/gi,"right")).addClass("mfp-prevent-close"),s=o?"mfpFastClick":"click";r[s](function(){t.prev()}),n[s](function(){t.next()}),t.isIE7&&(m("b",r[0],!1,!0),m("a",r[0],!1,!0),m("b",n[0],!1,!0),m("a",n[0],!1,!0)),t.container.append(r.add(n))}}),d("Change"+r,function(){t._preloadTimeout&&clearTimeout(t._preloadTimeout),t._preloadTimeout=setTimeout(function(){t.preloadNearbyImages(),t._preloadTimeout=null},16)}),d("Close"+r,function(){a.off(r),t.wrap.off("click"+r),t.arrowLeft&&o&&t.arrowLeft.add(t.arrowRight).destroyMfpFastClick(),t.arrowRight=t.arrowLeft=null})},next:function(){t.direction=!0,t.index=T(t.index+1),t.updateItemHTML()},prev:function(){t.direction=!1,t.index=T(t.index-1),t.updateItemHTML()},goTo:function(e){t.direction=e>=t.index,t.index=e,t.updateItemHTML()},preloadNearbyImages:function(){var e,i=t.st.gallery.preload,a=Math.min(i[0],t.items.length),r=Math.min(i[1],t.items.length);for(e=1;e<=(t.direction?r:a);e++)t._preloadItem(t.index+e);for(e=1;e<=(t.direction?a:r);e++)t._preloadItem(t.index-e)},_preloadItem:function(i){if(i=T(i),!t.items[i].preloaded){var a=t.items[i];a.parsed||(a=t.parseEl(i)),u("LazyLoad",a),"image"===a.type&&(a.img=e('<img class="mfp-img" />').on("load.mfploader",function(){a.hasSize=!0}).on("error.mfploader",function(){a.hasSize=!0,a.loadError=!0,u("LazyLoadError",a)}).attr("src",a.src)),a.preloaded=!0}}}});e.magnificPopup.registerModule("retina",{options:{replaceSrc:function(e){return e.src.replace(/\.\w+$/,function(e){return"@2x"+e})},ratio:1},proto:{initRetina:function(){if(window.devicePixelRatio>1){var e=t.st.retina,i=e.ratio;(i=isNaN(i)?i():i)>1&&(d("ImageHasSize.retina",function(e,t){t.img.css({"max-width":t.img[0].naturalWidth/i,width:"100%"})}),d("ElementParse.retina",function(t,a){a.src=e.replaceSrc(a,i)}))}}}}),function(){var t="ontouchstart"in window,i=function(){c.off("touchmove"+a+" touchend"+a)},a=".mfpFastClick";e.fn.mfpFastClick=function(r){return e(this).each(function(){var n,o=e(this);if(t){var s,l,d,m,u,p;o.on("touchstart"+a,function(e){m=!1,p=1,u=e.originalEvent?e.originalEvent.touches[0]:e.touches[0],l=u.clientX,d=u.clientY,c.on("touchmove"+a,function(e){u=e.originalEvent?e.originalEvent.touches:e.touches,p=u.length,u=u[0],(Math.abs(u.clientX-l)>10||Math.abs(u.clientY-d)>10)&&(m=!0,i())}).on("touchend"+a,function(e){i(),m||p>1||(n=!0,e.preventDefault(),clearTimeout(s),s=setTimeout(function(){n=!1},1e3),r())})})}o.on("click"+a,function(){n||r()})})},e.fn.destroyMfpFastClick=function(){e(this).off("touchstart"+a+" click"+a),t&&c.off("touchmove"+a+" touchend"+a)}}(),f()}),"function"!=typeof Object.create&&(Object.create=function(e){function t(){}return t.prototype=e,new t}),function(e,t,i,a){var r={init:function(t,i){var a=this;a.elem=i,a.$elem=e(i),a.options=e.extend({},e.fn.rtTab.options,t),a.rtTabs()},rtTabs:function(){var i=this,a=i.options.activeTab;if(i.$elem.find("li:nth-child("+a+")").addClass("active"),i.rtTabContent(activeTabContent="yes"),i.rtClick(),!0===("false"!==i.$elem.attr("data-hash"))){var r=t.location.hash;r&&i.$elem.find("li").find('a[href="'+r+'"]').trigger("click"),e(t).on("hashchange",function(){var e=t.location.hash;i.$elem.find("li").find('a[href="'+e+'"]').trigger("click")})}},rtClick:function(){var i=this,a=i.$elem.find("li");a.find("a").on("click",function(r){r.preventDefault(),a.removeClass("active"),i.rtTabContent(),e(this).parent().addClass("active");var n=e(this).attr("href");if(e(n).removeClass("hide"),!0===("false"!==i.$elem.attr("data-hash"))){var o=e(t).scrollTop();location.hash=e(this).attr("href"),e(t).scrollTop(o)}"function"==typeof i.options.onComplete&&i.options.onComplete.apply(i.elem,arguments)})},rtTabContent:function(t){this.$elem.find("li").find("a").each(function(){var i=e(this),a=i.attr("href");"yes"===t?i.parent().hasClass("active")||e(a).addClass("hide"):e(a).addClass("hide")})}};e.fn.rtTab=function(t){return this.each(function(){var i=Object.create(r);i.init(t,this),e.data(this,"rtTab",i)})},e.fn.rtTab.options={activeTab:1,onComplete:null}}(jQuery,window,document);var rtMagnificPopup,rtm_masonry_container,comment_media=!1,rtMediaHook={hooks:[],is_break:!1,register:function(e,t){void 0===rtMediaHook.hooks[e]&&(rtMediaHook.hooks[e]=[]),rtMediaHook.hooks[e].push(t)},call:function(e,arguments){if(void 0!==rtMediaHook.hooks[e])for(i=0;i<rtMediaHook.hooks[e].length;++i)if(1!=rtMediaHook.hooks[e][i](arguments))return rtMediaHook.is_break=!0,!1;return!0}};jQuery("document").ready(function(e){function t(){if(jQuery("#rtmedia-media-view-form").length>0){var e=jQuery("#rtmedia-media-view-form").attr("action");jQuery.post(e,{},function(e){})}}function i(){var e=jQuery.magnificPopup.instance;jQuery(".mfp-arrow-right").on("click",function(t){e.next()}),jQuery(".mfp-arrow-left").on("click",function(t){e.prev()}),jQuery(".mfp-content .rtmedia-media").swipe({swipeLeft:function(t,i,a,r,n){e.next()},swipeRight:function(t,i,a,r,n){e.prev()},threshold:0})}function a(){jQuery(".mfp-arrow-right").hide(),jQuery(".mfp-arrow-left").hide(),jQuery(document).unbind("keydown")}function r(){rtmedia_disable_popup_navigation("#comment_content")}function n(){jQuery(".rtmedia-container").on("click",".rtmedia-delete-media",function(e){e.preventDefault(),confirm(rtmedia_media_delete_confirmation)&&jQuery(this).closest("form").submit()})}jQuery(".rtmedia-uploader-div").css({opacity:"1",display:"block",visibility:"visible"}),jQuery(" #whats-new-options ").css({opacity:"1"}),void 0!==e.fn.rtTab&&e(".rtm-tabs").rtTab(),jQuery(".rtmedia-modal-link").length>0&&e(".rtmedia-modal-link").magnificPopup({type:"inline",midClick:!0,closeBtnInside:!0}),e("#rt_media_comment_form").submit(function(t){return""!=e.trim(e("#comment_content").val())||(0==jQuery("#rtmedia-single-media-container").length?rtmedia_gallery_action_alert_message(rtmedia_empty_comment_msg,"warning"):rtmedia_single_media_alert_message(rtmedia_empty_comment_msg,"warning"),!1)}),e("li.rtmedia-list-item p a").each(function(t){e(this).addClass("no-popup")}),e("li.rtmedia-list-item p a").each(function(t){e(this).addClass("no-popup")}),"undefined"!=typeof rtmedia_lightbox_enabled&&"1"==rtmedia_lightbox_enabled&&apply_rtMagnificPopup(".rtmedia-list-media.rtm-gallery-list, .rtmedia-activity-container ul.rtmedia-list, #bp-media-list,.bp-media-sc-list, li.media.album_updated ul,ul.bp-media-list-media, li.activity-item div.activity-content div.activity-inner div.bp_media_content, .rtm-bbp-container, ul.rtm-comment-container"),jQuery.ajaxPrefilter(function(e,t,i){try{if(null==t.data||void 0===t.data||void 0===t.data.action)return!0}catch(e){return!0}if("activity_get_older_updates"==t.data.action){a=t.success;e.success=function(e){a(e),apply_rtMagnificPopup(".rtmedia-activity-container ul.rtmedia-list, #bp-media-list, .bp-media-sc-list, li.media.album_updated ul,ul.bp-media-list-media, li.activity-item div.activity-content div.activity-inner div.bp_media_content"),rtMediaHook.call("rtmedia_js_after_activity_added",[])}}else if("get_single_activity_content"==t.data.action){var a=t.success;e.success=function(e){a(e),setTimeout(function(){apply_rtMagnificPopup(".rtmedia-activity-container ul.rtmedia-list, #bp-media-list, .bp-media-sc-list, li.media.album_updated ul,ul.bp-media-list-media, li.activity-item div.activity-content div.activity-inner div.bp_media_content"),jQuery("ul.activity-list li.rtmedia_update:first-child .wp-audio-shortcode, ul.activity-list li.rtmedia_update:first-child .wp-video-shortcode").mediaelementplayer({defaultVideoWidth:480,defaultVideoHeight:270})},900)}}}),jQuery.ajaxPrefilter(function(e,t,i){try{if(null==t.data||void 0===t.data||void 0===t.data.action)return!0}catch(e){return!0}if("activity_get_older_updates"==t.data.action){var a=t.success;e.success=function(e){a(e),apply_rtMagnificPopup(".rtmedia-activity-container ul.rtmedia-list, #bp-media-list, .bp-media-sc-list, li.media.album_updated ul,ul.bp-media-list-media, li.activity-item div.activity-content div.activity-inner div.bp_media_content"),jQuery("ul.activity-list li.rtmedia_update div.rtmedia-item-thumbnail > audio.wp-audio-shortcode, ul.activity-list li.rtmedia_update div.rtmedia-item-thumbnail > video.wp-video-shortcode").mediaelementplayer({defaultVideoWidth:480,defaultVideoHeight:270}),setTimeout(function(){rtmedia_activity_stream_comment_media()},900),rtMediaHook.call("rtmedia_js_after_activity_added",[])}}}),jQuery(".rtmedia-container").on("click",".select-all",function(e){jQuery(this).toggleClass("unselect-all").toggleClass("select-all"),jQuery(this).attr("title",rtmedia_unselect_all_visible),jQuery(".rtmedia-list input").each(function(){jQuery(this).prop("checked",!0)}),jQuery(".rtmedia-list-item").addClass("bulk-selected")}),jQuery(".rtmedia-container").on("click",".unselect-all",function(e){jQuery(this).toggleClass("select-all").toggleClass("unselect-all"),jQuery(this).attr("title",rtmedia_select_all_visible),jQuery(".rtmedia-list input").each(function(){jQuery(this).prop("checked",!1)}),jQuery(".rtmedia-list-item").removeClass("bulk-selected")}),jQuery(".rtmedia-container").on("click",".rtmedia-move",function(e){jQuery(".rtmedia-delete-container").slideUp(),jQuery(".rtmedia-move-container").slideToggle()}),jQuery("#rtmedia-create-album-modal").on("click","#rtmedia_create_new_album",function(t){if($albumname=jQuery("<span/>").text(jQuery.trim(jQuery("#rtmedia_album_name").val())).html(),$album_description=jQuery("#rtmedia_album_description"),$context=jQuery.trim(jQuery("#rtmedia_album_context").val()),$context_id=jQuery.trim(jQuery("#rtmedia_album_context_id").val()),$privacy=jQuery.trim(jQuery("#rtmedia_select_album_privacy").val()),$create_album_nonce=jQuery.trim(jQuery("#rtmedia_create_album_nonce").val()),""!=$albumname){var i={action:"rtmedia_create_album",name:$albumname,description:$album_description.val(),context:$context,context_id:$context_id,create_album_nonce:$create_album_nonce};""!==$privacy&&(i.privacy=$privacy),e("#rtmedia_create_new_album").attr("disabled","disabled");var a=e("#rtmedia_create_new_album").html();e("#rtmedia_create_new_album").prepend("<img src='"+rMedia_loading_file+"' />"),jQuery.post(rtmedia_ajax_url,i,function(t){if(void 0!==t.album){t=jQuery.trim(t.album);var i=!0;$album_description.val(""),e("#rtmedia_album_name").focus(),jQuery(".rtmedia-user-album-list").each(function(){if(jQuery(this).children("optgroup").each(function(){if(jQuery(this).attr("value")===$context)return i=!1,void jQuery(this).append('<option value="'+t+'">'+$albumname+"</option>")}),i){var e=$context.charAt(0).toUpperCase()+$context.slice(1)+" "+rtmedia_main_js_strings.rtmedia_albums,a='<optgroup value="'+$context+'" label="'+e+'"><option value="'+t+'">'+$albumname+"</option></optgroup>";jQuery(this).append(a)}}),jQuery('select.rtmedia-user-album-list option[value="'+t+'"]').prop("selected",!0),jQuery(".rtmedia-create-new-album-container").slideToggle(),jQuery("#rtmedia_album_name").val(""),jQuery("#rtmedia-create-album-modal").append("<div class='rtmedia-success rtmedia-create-album-alert'><b>"+$albumname+"</b>"+rtmedia_album_created_msg+"</div>"),setTimeout(function(){jQuery(".rtmedia-create-album-alert").remove()},4e3),setTimeout(function(){galleryObj.reloadView(),jQuery(".close-reveal-modal").click()},2e3)}else void 0!==t.error?rtmedia_gallery_action_alert_message(t.error,"warning"):rtmedia_gallery_action_alert_message(rtmedia_something_wrong_msg,"warning");e("#rtmedia_create_new_album").removeAttr("disabled"),e("#rtmedia_create_new_album").html(a)})}else rtmedia_gallery_action_alert_message(rtmedia_empty_album_name_msg,"warning")}),jQuery(".rtmedia-container").on("click",".rtmedia-delete-selected",function(e){jQuery(".rtmedia-list :checkbox:checked").length>0?confirm(rtmedia_selected_media_delete_confirmation)&&jQuery(this).closest("form").attr("action","../../../"+rtmedia_media_slug+"/delete").submit():rtmedia_gallery_action_alert_message(rtmedia_no_media_selected,"warning")}),jQuery(".rtmedia-container").on("click",".rtmedia-move-selected",function(e){jQuery(".rtmedia-list :checkbox:checked").length>0?confirm(rtmedia_selected_media_move_confirmation)&&jQuery(this).closest("form").attr("action","").submit():rtmedia_gallery_action_alert_message(rtmedia_no_media_selected,"warning")}),jQuery("#buddypress").on("change",".rtm-activity-privacy-opt",function(){var e=jQuery(this).attr("id");e=(e=e.split("-"))[e.length-1];var t=this;data={activity_id:e,privacy:jQuery(this).val(),nonce:jQuery("#rtmedia_activity_privacy_nonce").val(),action:"rtm_change_activity_privacy"},jQuery.post(ajaxurl,data,function(e){var i="",a="";"true"==e?(i=rtmedia_main_js_strings.privacy_update_success,a="success"):(i=rtmedia_main_js_strings.privacy_update_error,a="fail"),jQuery(t).after('<p class="rtm-ac-privacy-updated '+a+'">'+i+"</p>"),setTimeout(function(){jQuery(t).siblings(".rtm-ac-privacy-updated").remove()},2e3)})}),jQuery(".media_search_input").on("keyup",function(){rtm_search_media_text_validation()}),t(),rtMediaHook.register("rtmedia_js_popup_after_content_added",function(){t(),n(),mfp=jQuery.magnificPopup.instance,jQuery(mfp.items).size()>1&&0==comment_media?i():a(),r(),rtmedia_disable_popup_navigation_comment_media_focus();var o=e(window).height();jQuery(".rtm-lightbox-container .mejs-video").css({height:.8*o,"over-flow":"hidden"}),jQuery(".mfp-content .rtmedia-media").css({"max-height":.87*o,"over-flow":"hidden"}),rtmedia_init_action_dropdown(".rtm-lightbox-container .rtmedia-actions"),jQuery(".rtmedia-comment-link").on("click",function(e){e.preventDefault(),jQuery("#comment_content").focus()}),jQuery(".rtm-more").shorten({showChars:130});var s=e(".rtm-gallery-title"),l="";""!=(l=e.isEmptyObject(s)?e("#subnav.item-list-tabs li.selected ").html():s.html())&&e(".rtm-ltb-gallery-title .ltb-title").html(l);var c=e("#subnav.item-list-tabs li.selected span").html();return e("li.total").html(c),!0});var o=jQuery("#drag-drop-area"),s=jQuery("#whats-new");o.html();jQuery("#rtmedia-upload-container").after("<div id='rtm-drop-files-title'>"+rtmedia_drop_media_msg+"</div>"),"undefined"!=typeof rtmedia_bp_enable_activity&&"1"==rtmedia_bp_enable_activity&&jQuery("#whats-new-textarea").append("<div id='rtm-drop-files-title'>"+rtmedia_drop_media_msg+"</div>"),jQuery(document).on("dragover",function(e){e.preventDefault(),e.target!=this&&(jQuery("#rtm-media-gallery-uploader").show(),"undefined"!=typeof rtmedia_bp_enable_activity&&"1"==rtmedia_bp_enable_activity&&s.addClass("rtm-drag-drop-active"),o.addClass("rtm-drag-drop-active"),jQuery("#rtm-drop-files-title").show())}).on("dragleave",function(e){if(e.preventDefault(),0!=e.originalEvent.pageX&&0!=e.originalEvent.pageY)return!1;"undefined"!=typeof rtmedia_bp_enable_activity&&"1"==rtmedia_bp_enable_activity&&(s.removeClass("rtm-drag-drop-active"),s.removeAttr("style")),o.removeClass("rtm-drag-drop-active"),jQuery("#rtm-drop-files-title").hide()}).on("drop",function(e){e.preventDefault(),jQuery(".bp-suggestions").focus(),"undefined"!=typeof rtmedia_bp_enable_activity&&"1"==rtmedia_bp_enable_activity&&(s.removeClass("rtm-drag-drop-active"),s.removeAttr("style")),o.removeClass("rtm-drag-drop-active"),jQuery("#rtm-drop-files-title").hide()}),jQuery(".rtmedia-container").on("click",".rtmedia-delete-album",function(e){e.preventDefault(),confirm(rtmedia_album_delete_confirmation)&&jQuery(this).closest("form").submit()}),jQuery(".rtmedia-container").on("click",".rtmedia-delete-media",function(e){e.preventDefault(),confirm(rtmedia_media_delete_confirmation)&&jQuery(this).closest("form").submit()}),rtmedia_init_action_dropdown(""),e(document).click(function(){e(".click-nav ul").is(":visible")&&e(".click-nav ul",this).hide()}),jQuery(".rtmedia-comment-link").on("click",function(e){e.preventDefault(),jQuery("#comment_content").focus()}),jQuery(".rtm-more").length>0&&e(".rtm-more").shorten({showChars:200}),"undefined"!=typeof rtmedia_masonry_layout&&"true"==rtmedia_masonry_layout&&"undefined"!=typeof rtmedia_masonry_layout_activity&&"true"==rtmedia_masonry_layout_activity&&rtmedia_activity_masonry(),jQuery(document).ajaxComplete(function(e,t,i){var a=get_parameter("action",i.data);"post_update"!==a&&"get_single_activity_content"!==a&&"activity_get_older_updates"!==a||"undefined"==typeof rtmedia_masonry_layout||"true"!=rtmedia_masonry_layout||"undefined"==typeof rtmedia_masonry_layout_activity||"true"!=rtmedia_masonry_layout_activity||rtmedia_activity_masonry()}),"undefined"!=typeof rtmedia_masonry_layout&&"true"==rtmedia_masonry_layout&&0==jQuery(".rtmedia-container .rtmedia-list.rtm-no-masonry").length&&((rtm_masonry_container=jQuery(".rtmedia-container .rtmedia-list")).masonry({itemSelector:".rtmedia-list-item"}),setInterval(function(){jQuery.each(jQuery(".rtmedia-list.masonry .rtmedia-item-title"),function(e,t){jQuery(t).width(jQuery(t).siblings(".rtmedia-item-thumbnail").children("img").width())}),rtm_masonry_reload(rtm_masonry_container)},1e3),jQuery.each(jQuery(".rtmedia-list.masonry .rtmedia-item-title"),function(e,t){jQuery(t).width(jQuery(t).siblings(".rtmedia-item-thumbnail").children("img").width())})),jQuery(".rtm-uploader-tabs").length>0&&jQuery(".rtm-uploader-tabs li").click(function(e){jQuery(this).hasClass("active")||(jQuery(this).siblings().removeClass("active"),jQuery(this).parents(".rtm-uploader-tabs").siblings().hide(),class_name=jQuery(this).attr("class"),jQuery(this).parents(".rtm-uploader-tabs").siblings('[data-id="'+class_name+'"]').show(),jQuery(this).addClass("active"),"rtm-upload-tab"!=class_name?jQuery("div.moxie-shim").hide():jQuery("div.moxie-shim").show())}),jQuery(".rtmedia-container").on("click",".rtm-delete-media",function(e){e.preventDefault();var t="Are you sure you want to delete this media?";if("undefined"!=typeof rtmedia_media_delete_confirmation&&(t=rtmedia_media_delete_confirmation),confirm(t)){var i=jQuery(this).closest("li"),a={action:"delete_uploaded_media",nonce:jQuery("#rtmedia_media_delete_nonce").val(),media_id:i.attr("id")};jQuery.ajax({url:ajaxurl,type:"post",data:a,success:function(e){"1"==e?(rtmedia_gallery_action_alert_message(rtmedia_main_js_strings.file_delete_success,"success"),i.remove(),"undefined"!=typeof rtmedia_masonry_layout&&"true"==rtmedia_masonry_layout&&0==jQuery(".rtmedia-container .rtmedia-list.rtm-no-masonry").length&&rtm_masonry_reload(rtm_masonry_container)):rtmedia_gallery_action_alert_message(rtmedia_file_not_deleted,"warning")}})}})}),function(e){e.fn.shorten=function(t){"use strict";var i={showChars:100,minHideChars:10,ellipsesText:"...",moreText:rtmedia_read_more,lessText:rtmedia__show_less,onLess:function(){},onMore:function(){},errMsg:null,force:!1};return t&&e.extend(i,t),!(e(this).data("jquery.shorten")&&!i.force)&&(e(this).data("jquery.shorten",!0),e(document).off("click",".morelink"),e(document).on({click:function(){var t=e(this);return t.hasClass("less")?(t.removeClass("less"),t.html(i.moreText),t.parent().prev().hide(0,function(){t.parent().prev().prev().show()}).hide(0,function(){i.onLess()})):(t.addClass("less"),t.html(i.lessText),t.parent().prev().show(0,function(){t.parent().prev().prev().hide()}).show(0,function(){i.onMore()})),!1}},".morelink"),this.each(function(){var t=e(this),a=t.html();if(t.text().length>i.showChars+i.minHideChars){var r=a.substr(0,i.showChars);if(r.indexOf("<")>=0){for(var n=!1,o="",s=0,l=[],c=null,d=0,m=0;m<=i.showChars;d++)if("<"!=a[d]||n||(n=!0,"/"==(c=a.substring(d+1,a.indexOf(">",d)))[0]?c!="/"+l[0]?i.errMsg="ERROR en HTML: the top of the stack should be the tag that closes":l.shift():"br"!=c.toLowerCase()&&l.unshift(c)),n&&">"==a[d]&&(n=!1),n)o+=a.charAt(d);else if(m++,s<=i.showChars)o+=a.charAt(d),s++;else if(l.length>0){for(j=0;j<l.length;j++)o+="</"+l[j]+">";break}r=e("<div/>").html(o+'<span class="ellip">'+i.ellipsesText+"</span>").html()}else r+=i.ellipsesText;var u='<div class="shortcontent">'+r+'</div><div class="allcontent">'+a+'</div><span><a href="javascript://nop/" class="morelink">'+i.moreText+"</a></span>";t.html(u),t.find(".allcontent").hide(),e(".shortcontent p:last",t).css("margin-bottom",0)}}))}}(jQuery),window.onload=function(){"undefined"!=typeof rtmedia_masonry_layout&&"true"==rtmedia_masonry_layout&&0==jQuery(".rtmedia-container .rtmedia-list.rtm-no-masonry").length&&rtm_masonry_reload(rtm_masonry_container),rtm_search_media_text_validation(),check_condition("search")&&jQuery("#media_search_remove").show()};